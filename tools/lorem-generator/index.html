<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lorem Ipsum Generator | Linus Linhof</title>
    <link rel="stylesheet" href="../../assets/css/style.css">
    <link rel="icon" type="image/svg+xml" href="../../assets/favicon.svg">
</head>
<body>
    <main>
        <div class="container">
            <div class="tool-header">
                <h1>Lorem Ipsum Generator</h1>
                <p>Generate placeholder text for your designs. Choose between standard Latin, Tech Babble, or Corporate Speak.</p>
            </div>

            <div class="card">
                
                <div class="split-view">
                    <div>
                        <label for="theme">Theme</label>
                        <select id="theme">
                            <option value="latin">Standard (Latin)</option>
                            <option value="tech">Tech Babble</option>
                            <option value="corporate">Corporate Speak</option>
                        </select>

                        <label for="quantity">Quantity</label>
                        <input type="number" id="quantity" value="3" min="1" max="100">
                    </div>

                    <div>
                        <label for="type">Type</label>
                        <select id="type">
                            <option value="paragraphs">Paragraphs</option>
                            <option value="sentences">Sentences</option>
                            <option value="words">Words</option>
                        </select>

                        <label style="margin-top: 1.2rem;">Options</label>
                        
                        <label class="toggle-wrapper" for="startWithLorem" id="loremToggleWrapper">
                            <!-- Added ID to span for dynamic text updates -->
                            <span id="startWithLabel" style="flex-grow:1; cursor:pointer;">Start with "Lorem ipsum..."</span>
                            <input type="checkbox" id="startWithLorem" class="toggle-checkbox" checked>
                            <div class="toggle-switch"></div>
                        </label>

                        <label class="toggle-wrapper" for="htmlTags">
                            <span style="flex-grow:1; cursor:pointer;">Include HTML Tags (&lt;p&gt;)</span>
                            <input type="checkbox" id="htmlTags" class="toggle-checkbox">
                            <div class="toggle-switch"></div>
                        </label>
                    </div>
                </div>

                <div class="button-group">
                    <button class="button" id="generateBtn">Generate Text</button>
                    <button class="button outline" id="clearBtn">Clear</button>
                </div>

                <div class="result-box hidden" id="resultBox">
                    <label>Generated Text</label>
                    <div id="textOutput" class="code-view" style="max-height: 500px; overflow-y: auto;"></div>
                    
                    <div class="button-group" style="margin-top: 1rem;">
                        <button class="button sm secondary" id="copyBtn">Copy to Clipboard</button>
                    </div>
                </div>

            </div>
        </div>
    </main>
    
    <script src="../../assets/js/layout.js"></script>
    
    <script>
        // === DOM ELEMENTS ===
        const generateBtn = document.getElementById('generateBtn');
        const clearBtn = document.getElementById('clearBtn');
        const copyBtn = document.getElementById('copyBtn');
        const resultBox = document.getElementById('resultBox');
        const textOutput = document.getElementById('textOutput');
        
        const themeSelect = document.getElementById('theme');
        const quantityInput = document.getElementById('quantity');
        const typeSelect = document.getElementById('type');
        const startWithLoremCheck = document.getElementById('startWithLorem');
        const loremToggleWrapper = document.getElementById('loremToggleWrapper');
        const startWithLabel = document.getElementById('startWithLabel');
        const htmlTagsCheck = document.getElementById('htmlTags');

        // === VOCABULARIES ===
        const vocabs = {
            latin: [
                "lorem", "ipsum", "dolor", "sit", "amet", "consectetur", "adipiscing", "elit", 
                "sed", "do", "eiusmod", "tempor", "incididunt", "ut", "labore", "et", "dolore", 
                "magna", "aliqua", "ut", "enim", "ad", "minim", "veniam", "quis", "nostrud", 
                "exercitation", "ullamco", "laboris", "nisi", "ut", "aliquip", "ex", "ea", 
                "commodo", "consequat", "duis", "aute", "irure", "dolor", "in", "reprehenderit", 
                "in", "voluptate", "velit", "esse", "cillum", "dolore", "eu", "fugiat", "nulla", 
                "pariatur", "excepteur", "sint", "occaecat", "cupidatat", "non", "proident", 
                "sunt", "in", "culpa", "qui", "officia", "deserunt", "mollit", "anim", "id", 
                "est", "laborum"
            ],
            tech: [
                "algorithm", "bandwidth", "cloud", "digital", "encryption", "firewall", "gigabit", 
                "heuristic", "ip", "json", "kernel", "logic", "matrix", "network", "open-source", 
                "protocol", "quantum", "router", "server", "token", "url", "virtual", "wireless", 
                "xml", "backend", "frontend", "api", "cache", "data", "ethernet", "firmware", 
                "gateway", "hardware", "interface", "javascript", "keyboard", "latency", "malware", 
                "node", "offline", "packet", "query", "runtime", "socket", "terminal", "upload", 
                "vector", "widget", "zip", "array", "binary", "cyber", "debug", "syntax"
            ],
            corporate: [
                "agile", "benchmark", "circle-back", "deliverables", "empower", "feedback", "growth", 
                "holistic", "innovate", "journey", "kpi", "leverage", "mindset", "networking", 
                "optimize", "pivot", "quarterly", "roi", "synergy", "touchpoint", "upside", 
                "value-add", "win-win", "alignment", "bandwidth", "core-competency", "disrupt", 
                "ecosystem", "framework", "granular", "hardball", "ideation", "jargon", "key-takeaway", 
                "low-hanging-fruit", "moving-forward", "next-steps", "onboarding", "paradigm-shift", 
                "quota", "roadmap", "scalability", "traction", "utilize", "vertical", "wheelhouse", 
                "yield", "zone"
            ]
        };

        // === STARTING PHRASES ===
        const startingPhrases = {
            latin: "Lorem ipsum dolor sit amet, consectetur adipiscing elit",
            tech: "Algorithm bandwidth cloud digital encryption, firewall gigabit heuristic",
            corporate: "Agile benchmark circle-back deliverables, empower feedback growth"
        };

        // === LOGIC ===

        // Handle Theme Change UI (Updates Toggle Label)
        themeSelect.addEventListener('change', () => {
            const theme = themeSelect.value;
            const phrase = startingPhrases[theme];
            
            // Extract first two words for label brevity (e.g. "Start with 'Agile benchmark...'")
            const shortPhrase = phrase.split(' ').slice(0, 2).join(' ');
            
            startWithLabel.textContent = `Start with "${shortPhrase}..."`;
            
            // Ensure toggle is active and reset
            startWithLoremCheck.disabled = false;
            loremToggleWrapper.style.opacity = '1';
            startWithLoremCheck.checked = true;
        });

        function getRandomWord(theme) {
            const list = vocabs[theme];
            return list[Math.floor(Math.random() * list.length)];
        }

        function capitalize(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        function generateSentence(theme, minWords = 8, maxWords = 15) {
            const length = Math.floor(Math.random() * (maxWords - minWords + 1)) + minWords;
            let sentence = [];
            for (let i = 0; i < length; i++) {
                sentence.push(getRandomWord(theme));
            }
            // Add random commas
            if (length > 10 && Math.random() > 0.5) {
                const commaIndex = Math.floor(Math.random() * (length - 4)) + 2;
                sentence[commaIndex] += ",";
            }
            
            let text = sentence.join(" ");
            return capitalize(text) + ".";
        }

        function generateParagraph(theme, numSentences) {
            let sentences = [];
            for (let i = 0; i < numSentences; i++) {
                sentences.push(generateSentence(theme));
            }
            return sentences.join(" ");
        }

        function generateText() {
            const quantity = parseInt(quantityInput.value) || 1;
            const type = typeSelect.value;
            const theme = themeSelect.value;
            const startPhrase = startingPhrases[theme];
            const startEnabled = startWithLoremCheck.checked;
            const useHtml = htmlTagsCheck.checked;

            let output = "";
            let rawTextArray = [];

            // 1. Generate Raw Data
            if (type === 'words') {
                for (let i = 0; i < quantity; i++) {
                    rawTextArray.push(getRandomWord(theme));
                }
                output = rawTextArray.join(" ");
            } 
            else if (type === 'sentences') {
                for (let i = 0; i < quantity; i++) {
                    rawTextArray.push(generateSentence(theme));
                }
                output = rawTextArray.join(" ");
            } 
            else {
                // Paragraphs
                for (let i = 0; i < quantity; i++) {
                    const sentenceCount = Math.floor(Math.random() * 4) + 3;
                    rawTextArray.push(generateParagraph(theme, sentenceCount));
                }
                output = rawTextArray.join("\n\n");
            }

            // 2. Handle "Start with..." logic
            if (startEnabled) {
                if (type === 'words') {
                    const standardWords = startPhrase.toLowerCase().replace(/[.,]/g, '').split(' ');
                    let currentWords = output.split(' ');
                    
                    if (quantity < standardWords.length) {
                        output = standardWords.slice(0, quantity).join(' ');
                    } else {
                        currentWords.splice(0, standardWords.length, ...standardWords);
                        output = currentWords.join(' ');
                    }
                } 
                else {
                    // For Sentences and Paragraphs
                    let cleanStart = startPhrase; 
                    
                    // If generated text is shorter than the start phrase, just return start phrase
                    if (output.length < cleanStart.length) {
                        output = cleanStart + ".";
                    } else {
                        // Slice off the beginning of the generated text and replace with standard start
                        // We remove roughly the same amount of characters to keep length consistent
                        output = cleanStart + output.substring(cleanStart.length).replace(/^\s*[a-z]/, c => c); 
                        
                        // Ensure it ends with punctuation if we cut it weirdly
                        if (!output.trim().endsWith(".")) output += ".";
                    }
                }
            }

            // 3. Handle HTML Tags
            if (useHtml) {
                if (type === 'paragraphs') {
                    output = rawTextArray.map((p, index) => {
                        // Force the first paragraph to look right if "Start..." is on
                        // We have to reconstruct it because 'output' is currently a flat string
                        if (index === 0 && startEnabled) {
                           // Re-slice from the flattened output logic above is hard, 
                           // simpler to just force the prefix on the first paragraph array item
                           let firstP = p;
                           if (p.length > startPhrase.length) {
                               firstP = startPhrase + p.substring(startPhrase.length);
                           } else {
                               firstP = startPhrase + ".";
                           }
                           return `<p>${firstP}</p>`; 
                        }
                        return `<p>${p}</p>`;
                    }).join("\n");
                } else if (type === 'sentences') {
                     // Wrap sentences
                     // If startEnabled, we must ensure the first sentence in HTML matches the startPhrase
                     let sentences = output.split('. ').filter(s => s.trim().length > 0);
                     output = sentences.map(s => {
                         // Strip existing dot to avoid double dots
                         let clean = s.replace(/\.$/, '');
                         return `<span>${clean}.</span>`;
                     }).join(" ");
                } else {
                    // Words
                    output = `<p>${output}</p>`;
                }
            } else {
                 // Plain Text corrections
                 if (type === 'paragraphs' && startEnabled) {
                     // Ensure the very first paragraph in the text block starts correctly
                     let paragraphs = output.split("\n\n");
                     // Check first few words
                     const firstWords = startPhrase.split(' ')[0];
                     if (!paragraphs[0].startsWith(firstWords)) {
                         paragraphs[0] = startPhrase + paragraphs[0].substring(startPhrase.length);
                         output = paragraphs.join("\n\n");
                     }
                 }
            }

            textOutput.innerText = output;
            resultBox.classList.remove('hidden');
            resultBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // === EVENT LISTENERS ===

        generateBtn.addEventListener('click', () => {
            try {
                generateText();
                showToast('Text generated', 'success');
            } catch (e) {
                console.error(e);
                showToast('Error generating text', 'error');
            }
        });

        clearBtn.addEventListener('click', () => {
            textOutput.innerText = '';
            resultBox.classList.add('hidden');
            quantityInput.value = 3;
            typeSelect.value = 'paragraphs';
            
            // Reset Theme to Latin
            themeSelect.value = 'latin';
            startWithLabel.textContent = 'Start with "Lorem ipsum..."';
            startWithLoremCheck.disabled = false;
            startWithLoremCheck.checked = true;
            loremToggleWrapper.style.opacity = '1';
            
            htmlTagsCheck.checked = false;
        });

        copyBtn.addEventListener('click', () => {
            const text = textOutput.innerText;
            if(text) copyToClipboard(text);
        });
        
        // Initial run
        window.onload = generateText;
    </script>
</body>
</html>